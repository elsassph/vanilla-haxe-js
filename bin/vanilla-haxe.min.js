/*! vanilla-haxe 02-11-2014 */
!function(){"use strict";var a=function(){};a.exists=function(a,b){for(var c=a.iterator();c.hasNext();){var d=c.next();if(b(d))return!0}return!1};var b=function(){this.length=0};b.prototype={iterator:function(){return{h:this.h,hasNext:function(){return null!=this.h},next:function(){if(null==this.h)return null;var a=this.h[0];return this.h=this.h[1],a}}}};var c=function(){this.createChildren(),this.loadData()};c.main=function(){new c},c.prototype={createChildren:function(){var a=this,b=window.document;this.view=b.createElement("div"),this.view.className="listview",this.list=b.createElement("ul"),this.button=b.createElement("button"),this.button.textContent="Add an item",this.button.onclick=function(){a.data.push({label:"New item "+(a.data.length+1),id:a.data.length}),a.render()},this.view.appendChild(this.list),this.view.appendChild(this.button),b.body.appendChild(this.view)},loadData:function(){var a=this,b=new d.Http("data.json");b.onData=function(b){try{if(a.data=JSON.parse(b),!(a.data instanceof Array&&null==a.data.__enum__))throw"ArgumentError: Json data is not an array";a.render()}catch(c){alert(c)}},b.request()},render:function(){for(var a=window.document,b=a.createDocumentFragment(),c=0,d=this.data;c<d.length;){var e=d[c];++c;var f=a.createElement("li"),g=a.createElement("div");g.textContent=e.label,f.appendChild(g),b.appendChild(f)}this.list.innerHTML="",this.list.appendChild(b)}};var d={};d.Http=function(a){this.url=a,this.headers=new b,this.params=new b,this.async=!0},d.Http.prototype={request:function(b){var c=this;c.responseData=null;var d=this.req=e.Browser.createXMLHttpRequest(),f=function(){if(4==d.readyState){var a;try{a=d.status}catch(b){a=null}if(void 0==a&&(a=null),null!=a&&c.onStatus(a),null!=a&&a>=200&&400>a)c.req=null,c.onData(c.responseData=d.responseText);else if(null==a)c.req=null,c.onError("Failed to connect or resolve host");else switch(a){case 12029:c.req=null,c.onError("Failed to connect to host");break;case 12007:c.req=null,c.onError("Unknown host");break;default:c.req=null,c.responseData=d.responseText,c.onError("Http Error #"+d.status)}}};this.async&&(d.onreadystatechange=f);var g=this.postData;if(null!=g)b=!0;else for(var h=this.params.iterator();h.hasNext();){var i=h.next();null==g?g="":g+="&",g+=encodeURIComponent(i.param)+"="+encodeURIComponent(i.value)}try{if(b)d.open("POST",this.url,this.async);else if(null!=g){var j=this.url.split("?").length<=1;d.open("GET",this.url+(j?"?":"&")+g,this.async),g=null}else d.open("GET",this.url,this.async)}catch(k){return c.req=null,void this.onError(k.toString())}!a.exists(this.headers,function(a){return"Content-Type"==a.header})&&b&&null==this.postData&&d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");for(var l=this.headers.iterator();l.hasNext();){var m=l.next();d.setRequestHeader(m.header,m.value)}d.send(g),this.async||f(null)},onData:function(){},onError:function(){},onStatus:function(){}};var e={};e.Browser=function(){},e.Browser.createXMLHttpRequest=function(){if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)return new ActiveXObject("Microsoft.XMLHTTP");throw"Unable to create XMLHttpRequest object."},c.main()}();